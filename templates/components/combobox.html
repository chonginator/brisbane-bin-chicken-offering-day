{{ define "combobox" }}
<script src="/static/components/combobox.js"></script>

<div id="combobox-container" class="flex flex-col gap-2" data-combobox>
  <form
    class="peer flex gap-2 lg:gap-4 w-full bg-white p-4 outline-2 outline-grey-300 focus-within:outline-graphite-500 rounded-lg">
    <label class="flex items-center" for="address-search">
      <svg width="24" height="24" viewBox="0 0 23 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd"
          d="M10.2353 0.735291C8.6407 0.735426 7.06925 1.1169 5.65207 1.84787C4.23488 2.57885 3.01305 3.63813 2.08851 4.93735C1.16398 6.23657 0.563541 7.73805 0.337304 9.31652C0.111067 10.895 0.265588 12.5047 0.787975 14.0113C1.31036 15.5179 2.18547 16.8777 3.34028 17.9773C4.49509 19.0769 5.89612 19.8844 7.42649 20.3325C8.95685 20.7805 10.5722 20.8561 12.1377 20.5528C13.7032 20.2496 15.1735 19.5764 16.4259 18.5894L20.7224 22.8859C20.9442 23.1002 21.2414 23.2188 21.5499 23.2161C21.8584 23.2134 22.1534 23.0897 22.3716 22.8715C22.5897 22.6534 22.7134 22.3583 22.7161 22.0499C22.7188 21.7414 22.6002 21.4442 22.3859 21.2223L18.0894 16.9259C19.2518 15.4513 19.9755 13.6793 20.1778 11.8126C20.38 9.94594 20.0527 8.06002 19.2332 6.37069C18.4137 4.68137 17.1352 3.25689 15.5439 2.26027C13.9526 1.26365 12.1129 0.735164 10.2353 0.735291ZM2.58824 10.7353C2.58824 8.70716 3.39391 6.76211 4.82801 5.328C6.26211 3.8939 8.20717 3.08823 10.2353 3.08823C12.2634 3.08823 14.2085 3.8939 15.6426 5.328C17.0767 6.76211 17.8824 8.70716 17.8824 10.7353C17.8824 12.7634 17.0767 14.7085 15.6426 16.1426C14.2085 17.5767 12.2634 18.3824 10.2353 18.3824C8.20717 18.3824 6.26211 17.5767 4.82801 16.1426C3.39391 14.7085 2.58824 12.7634 2.58824 10.7353Z"
          fill="#72716C" />
      </svg>
      <span class="sr-only">Search For Your Address</span>
    </label>
    <input id="address-search" type="search" name="q" value="{{ .Query }}" placeholder="Search addresses..."
      hx-get="/suburbs" hx-trigger="input changed delay:500ms" hx-target="[role=listbox]"
      hx-select="[role=listbox] > [role=option]" hx-swap="innerHTML"
      class="font-satoshi font-normal text-base lg:text-xl text-graphite-200 w-full bg-white focus-within:outline-none [&::-webkit-search-cancel-button]:hidden"
      autocomplete="off" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-activedescendant
      aria-controls="listbox" aria-labelledby="address-search-label">
  </form>
  <ul id="listbox"
    class="invisible peer-focus-within:visible flex flex-col max-h-[232px] lg:max-h-[272px] p-4 overflow-y-auto bg-white border-2 border-grey-200 rounded-lg shadow-md"
    role="listbox" hidden>
    {{ range $i, $suburb := .Suburbs }}
    <li id="option-{{ $i }}" class="flex w-full" role="option" aria-selected="false">
      <a href="/suburbs/{{ $suburb.Slug }}/streets" hx-target="#main" hx-select="#main"
        class="font-satoshi text-base lg:text-xl text-graphite-500 w-full px-8 lg:px-10 py-2 lg:py-4 hover:bg-grey-100 transition-colors rounded-sm">{{
        $suburb.Name }}</a>
    </li>
    {{ end }}
  </ul>
</div>
{{ end }}